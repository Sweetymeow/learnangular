<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <title>SAP Next-Gen Map Viz</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="material.min.css">
    <link rel="stylesheet" href="p1_mapbox_cluster.css">
    <!--    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue_grey-orange.min.css" />-->
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.js'></script>
</head>

<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header mdl-layout__header--waterfall portfolio-header">
            <div class="mdl-layout__header-row portfolio-logo-row">
                <span class="mdl-layout-title">SAP Next-Gen Network</span>
                <div class="mdl-layout-spacer"></div>
                <img src="Next-Gen-logo.png" alt="" class="next-gen-logo">
            </div>
            <div class="mdl-layout__header-row portfolio-navigation-row mdl-layout--large-screen-only">
                <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
                    <a class="mdl-navigation__link is-active" href="p1_mapbox_cluster.html">Home</a>
                    <a class="mdl-navigation__link" href="p2_regist_form.html">Registration</a>
                    <a class="mdl-navigation__link" href="p3_network.html">Solar Network</a>
                </nav>
            </div>
        </header>

        <div class="mdl-layout__drawer mdl-layout--small-screen-only">
            <nav class="mdl-navigation mdl-typography--body-1-force-preferred-font">
                <a class="mdl-navigation__link is-active" href="p1_mapbox_cluster.html">Home</a>
                <a class="mdl-navigation__link" href="p2_registForm.html">Registration</a>
                <a class="mdl-navigation__link" href="p3_network.html">Solar Network</a>
            </nav>
        </div>

        <main class="mdl-layout__content">
<!--
            <div id="join-regist">
                <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                    JOIN Network
                </button>
            </div>
-->
            <a href="p2_regist_form.html" target="_blank" id="join-regist" 
                class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-color--accent mdl-color-text--accent-contrast">JOIN</a>
            <div id='map'></div>
            <div class="mdl-grid portfolio-max-width">
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">131</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Countries</div>
                </div>
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">3421</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Educational Intitution</div>
                </div>
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">1123</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Customers</div>
                </div>
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">18</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Next-Gen Members</div>
                </div>
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone ">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">1123</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Customers</div>
                </div>
                <div class="mdl-cell mdl-card mdl-shadow--4dp portfolio-card mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone ">
                    <div class="mdl-card__title">
                        <h2 class="mdl-card__title-text">18</h2>
                    </div>
                    <div class="mdl-card__supporting-text">Next-Gen Members</div>
                </div>
            </div>
        </main>
    </div>

    <script>
        mapboxgl.accessToken = 'pk.eyJ1Ijoic3dlZXR5bWVvdyIsImEiOiJjaXoxdHM4aWowNHI2MnFxZjZtbmw4cDJ4In0.1140mL1gVeMEdPvgmOOG0g';
        var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/dark-v9',
            center: [-103.59179687498357, 40.66995747013945],
            zoom: 3
        });

        map.on('load', function () {

            // Add a new source from our GeoJSON data and set the
            // 'cluster' option to true.
            map.addSource("earthquakes", {
                type: "geojson",
                // Point to GeoJSON data. This example visualizes all M1.0+ earthquakes
                // from 12/22/15 to 1/21/16 as logged by USGS' Earthquake hazards program.
                data: "earthquakes.geojson",
                cluster: true,
                clusterMaxZoom: 14, // Max zoom to cluster points on
                clusterRadius: 50 // Radius of each cluster when clustering points (defaults to 50)
            });

            // Use the earthquakes source to create five layers:
            // One for unclustered points, three for each cluster category,
            // and one for cluster labels.
            map.addLayer({
                "id": "unclustered-points",
                "type": "symbol",
                "source": "earthquakes",
                "filter": ["!has", "point_count"],
                "layout": {
                    "icon-image": "marker-15"
                }
            });

            // Display the earthquake data in three layers, each filtered to a range of
            // count values. Each range gets a different fill color.
            var layers = [[150, '#f28cb1'], [20, '#f1f075'], [0, '#51bbd6']];


            layers.forEach(function (layer, i) {
                map.addLayer({
                    "id": "cluster-" + i,
                    "type": "circle",
                    "source": "earthquakes",
                    "paint": {
                        "circle-color": layer[1],
                        "circle-radius": 18
                    },
                    "filter": i === 0 ? 
                    [">=", "point_count", layer[0]] : 
                    [
                        "all",
                        [">=", "point_count", layer[0]],
                        ["<", "point_count", layers[i - 1][0]]
                                                                          
                    ]
                });
            });

            // Add a layer for the clusters' count labels
            map.addLayer({
                "id": "cluster-count",
                "type": "symbol",
                "source": "earthquakes",
                "layout": {
                    "text-field": "{point_count}",
                    "text-font": [
                "DIN Offc Pro Medium",
                "Arial Unicode MS Bold"
            ],
                    "text-size": 12
                }
            });

            map.resize();
        });

    </script>

</body>

</html>
